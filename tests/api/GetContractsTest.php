<?php

namespace api;

use Exception;
use GuzzleHttp\Client;
use GuzzleHttp\Cookie\CookieJar;
use GuzzleHttp\Exception\ClientException;
use GuzzleHttp\Exception\GuzzleException;
use PHPUnit\Framework\TestCase;
use Sql;

require_once dirname(dirname(__DIR__)) . DIRECTORY_SEPARATOR . 'src' . DIRECTORY_SEPARATOR . 'autoloader.php';

class GetContractsTest extends TestCase {
    /**
     * @var Client
     */
    private $http;
    /**
     * @var Sql
     */
    private $sql;

    /**
     * @throws Exception
     */
    public function setUp() {
        $this->http = new Client(['base_uri' => 'http://' . getenv('DB_HOST') . ':90/']);
        $this->sql = new Sql();
        $this->sql->executeStatement("INSERT INTO `contracts` (`id`, `link`, `type`, `name`, `address`, `number`, `email`, `date`, `location`, `session`, `details`, `amount`, `deposit`, `invoice`, `content`, `signature`, `initial`, `file`) VALUES (998, '8e07fb32bf072e1825df8290a7bcdc57', 'commercial', 'MaxMaxMax', 'Address', '1234567890', 'email-address', '2021-10-13', '1234 Sesame Street', 'Some session', 'Up to one hour photo session to include:\r\n\r\nBusiness Headshots:\r\n- Web gallery for viewing/making selects\r\n- One file of your choice, color corrected/retouched per person\r\n- Additional files can be purchased for $80/file\r\n- Print release for marketing/web needs for purchased/included files\r\n\r\nOffice Photos:\r\n- All images delivered via web gallery for download\r\n- Print release for marketing/web needs', '0.00', '0.00', 'nope!', '    <h2>Saperstone Studios LLC. Commercial Contract</h2>\n    \n    <p>\n        <strong>This Contract</strong> is made by and between <u>&nbsp;Saperstone\n            Studios&nbsp;</u> (the \"Photographer\") and <u>&nbsp;MaxMaxMax&nbsp;\n        </u>(the \"Client\").<br> <strong>Whereas</strong>, Client wishes to\n        engage Photographer to provide certain photography services and\n        Photographer is willing to accept such engagement, all on the terms\n        and conditions set forth herein.<br> <strong>Now therefore</strong>,\n        in consideration of the mutual promises contained herein and other\n        good and valuable consideration, the receipt and sufficiency of which\n        is hereby acknowledged, the parties agree as follows:\n    </p>\n    <ol>\n        <li><strong>Services.</strong> Photographer hereby agrees to provide\n            the photography services set forth on the attached Statement of\n            Services (the \"Services\") to the best of her abilities.</li>\n        <li><strong>Compensation.</strong> In consideration of the Services,\n            Client agrees to pay Photographer the following amounts as follows:\n            <p>\n                            <span class=\"contract-line-item\"> Hugs: $20 / Kiss\n                    <br>\n                </span>\n                            <span class=\"contract-line-item\"><br>Kisses: $50 / Unit <br></span>\n                <br>  <br>Checks should\n                be made payable to <em>Saperstone Studios</em> and mailed to <em>5012\n                    Whisper Willow Dr, Fairfax VA 22030</em>. Final balance is due with\n                delivered invoice, paid no later than 30 days of delivery, in\n                compliance with Terms and Conditions.\n            </p></li>\n        <li><strong>Session Details.</strong> The above session with take\n            place at the below location on 2021-10-13 <br> 1234 Sesame Street</li>\n        <li><strong>Term.</strong> The initial term of this Contract shall\n            commence on the date hereof and terminate upon completion of the\n            services. Client may terminate this Contract at any time upon 30 days\n            advance written notice. Client shall be liable for the expenses\n            enumerated upon termination. Photographer shall have the right to\n            terminate this Agreement upon 30 days advance written notice and upon\n            return of amounts paid for remaining Services not provided, less\n            expenses.</li>\n        <li><strong>Standard Terms.</strong> Attached hereto is a statement of\n            Standard Terms and Conditions which will apply to the relationship\n            between Photographer and Client; such terms and conditions are\n            incorporated herein by this reference.</li>\n    </ol>\n    <p>\n        <strong>In witness whereof</strong>, the undersigned have caused this\n        Contract to be executed as of the date first above written.\n    \n    \n    </p><h4>Client:</h4>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Name:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-name-signature\" class=\"form-control keep\" type=\"text\" placeholder=\"Client Name\" value=\"\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Signature:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <div id=\"contract-signature\" class=\"signature\"></div>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Address:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <textarea id=\"contract-address\" class=\"form-control keep\" type=\"text\" placeholder=\"Client Address\" value=\"\">Address</textarea>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Phone Number:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-number\" class=\"form-control keep\" type=\"tel\" placeholder=\"Client Phone Number\" value=\"1234567890\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Email: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-email\" class=\"form-control keep\" type=\"email\" placeholder=\"Client Email\" value=\"email-address\">\n        </div>\n    </div>\n    <h4>Photographer:</h4>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Name:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            Saperstone Studios<br> Leigh Ann Saperstone\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Address: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            5012 Whisper Willow Dr.<br>Fairfax, VA 22030\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Phone Number:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <a target=\"_blank\" href=\"tel:5712660004\">(571) 266-0004</a>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Email:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <a target=\"_blank\" href=\"mailto:contracts@saperstonestudios.com\">contracts@saperstonestudios.com</a>\n        </div>\n    </div>\n    <p></p>\n    <h3>Exhibit A: Statement Of Services</h3>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Project/Assignment:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            Some session\n        </div>\n    </div>\n    Up to one hour photo session to include:<br><br>Business Headshots:<br>- Web gallery for viewing/making selects<br>- One file of your choice, color corrected/retouched per person<br>- Additional files can be purchased for $80/file<br>- Print release for marketing/web needs for purchased/included files<br><br>Office Photos:<br>- All images delivered via web gallery for download<br>- Print release for marketing/web needs\n    <h3>Standard Terms and Conditions</h3>\n    <p>\n        <strong>Copyright.</strong> The photographs produced by Photographer\n        shall be the intellectual property and copyrighted works of\n        Photographer, and shall not be deemed to be works made for hire.\n        Photographer agrees to give, upon payment in full, a limited usage\n        license to Client for reproduction and display of selected\n        photographs, including private or internal use by Client or its\n        employees and reasonable use in business communications by Client\n        (such as website, newsletter or annual report). Additionally, the\n        files delivered may only be reproduced for Clientâ€™s use and cannot\n        under any circumstance be sold to, licensed to, or used by a\n        third-party without written authorization from Photographer.\n        Photographer retains creative control over the images produced and all\n        decisions made by Photographer with regards to edits are deemed final.\n    </p>\n    <p>\n        <strong>Credit.</strong> In any publication, display, exhibit or other\n        permitted use of the photographs of Photographer, Client agrees to\n        include photo credit to Photographer and include a copyright notice\n        evidence of Photographerâ€™s ownership thereof. In addition, in any\n        publication in which the artists are recognized, Client shall include\n        a brief biography of Photographer approved by Photographer of\n        comparable position and prominence to other artists whose work is\n        included.\n    </p>\n    <p>\n        <strong>Retouch.</strong> Retouching is included but at the\n        Photographers discretion. Any additional retouch requests are handled\n        on a case by case basis and a separate fee may be negotiated.\n    </p>\n    <p>\n        <strong>Scheduling.</strong> Client will be responsible for insuring\n        access and authority to enable Photographer to shoot on the dates set\n        forth. If Photographer is unable to shoot on the dates scheduled for\n        reasons beyond Photographerâ€™s or Clientâ€™s reasonable control, the\n        parties will endeavor to agree on mutually acceptable alternative\n        dates, subject to Photographer availability.\n    </p>\n    <p>\n        <strong>Color Changes.</strong> Client recognizes that color dyes in\n        photography may fade or discolor over time due to the inherent\n        qualities of dyes; Photographer shall have no liability for any claims\n        based upon fading or discoloration due to such inherent qualities.\n    </p>\n    <p>\n        <strong>Advertising.</strong> Client gives Photographer permission to\n        use photographs for advertising (example: website).\n    </p>\n    <p>\n        <strong>Payment &amp; Charges.</strong> If any payment due Photographer is\n        not be made within 30 days of its due date, Photographer shall have\n        the options to assess a service charge equal 1.5% of the outstanding\n        amount each month (or fraction thereof) thereafter that payment is\n        late. If Photographer institutes any proceeding to obtain payment from\n        Client, Client will pay any costs and expenses (including reasonable\n        attorney\'s fees) incurred by Photographer in connection therewith. If\n        check payment does not process, client is liable for all processing,\n        late and overdraft charges.\n    </p>\n    <p>\n        <strong>Limit on Liability.</strong> Absent willful misconduct or\n        infringement by Photographer of intellectual property rights of any\n        third party, the liability of Photographer to Client arising out of\n        the Services shall not exceed the fees paid to Photographer hereunder.\n        In no event shall Photographer have any liability for special,\n        incidental, indirect, consequential or punitive damages hereunder.\n    </p>\n    <p>\n        <strong>Permissions.</strong> Client shall be solely responsible for\n        obtaining all permissions and consent of persons whose photographs are\n        taken and of owners of property and indemnify Photographer from any\n        claims, costs and expenses arising from any failure to do so.\n    </p>\n    <p>\n        <strong>Relationship.</strong> The relationship between Photographer\n        and Client is one of independent contractor. Photographer shall be\n        responsible for payment of all federal, state and local income,\n        payroll and withholding taxes and assessments arising from or\n        attributable to receipt of payments hereunder.\n    </p>\n    <p>\n        <strong>Miscellaneous.</strong> (a) The provisions hereof shall\n        survive termination of this Agreement; (b) this Agreement will be\n        governed by the laws of the State of Virginia (c) this Agreement\n        contains the entire agreement between the parties with respect to the\n        subject matter hereof and supersedes all prior understandings among\n        the parties with respect thereto; this Agreement may be changed only\n        in writing signed by the party against whom enforcement is sought; (d)\n        this Agreement may be executed in counterpart originals, each of which\n        shall constitute an original and all of which together shall\n        constitute a single document and shall be effective upon execution by\n        both parties; and (e) this Agreement shall be binding upon the parties\n        hereto and their respective successors and assigns; no party shall\n        assign its duties or obligations hereunder without the prior written\n        consent of the other party hereto.\n    </p>\n', NULL, NULL, NULL)");
        $this->sql->executeStatement("INSERT INTO `contracts` (`id`, `link`, `type`, `name`, `address`, `number`, `email`, `date`, `location`, `session`, `details`, `amount`, `deposit`, `invoice`, `content`, `signature`, `initial`, `file`) VALUES (999, '735870e9bd79af1904a0a2eb453430ed', 'wedding', 'Max Saperstone', '5012 Whisper Willow Dr\r\nFairfax, VA 22030', '(571) 245-3351', 'msaperst+sstest@gmail.com', '1983-10-13', NULL, 'Platinum Package', '800+ color managed and retouched images with print release\r\n9 hours of wedding day coverage\r\n2nd photographer\r\nEngagement session\r\nEngagement sign in book\r\nPhotobooth\r\nWeb gallery for sharing\r\nUSB of final images\r\n$200 print credit', '4300.00', '2000.00', 'bullshit ;)', '    <h2>Saperstone Studios LLC. Wedding Contract</h2><p>\n        <strong>This Contract</strong> is made by and between <u>&nbsp;Saperstone\n            Studios&nbsp;</u> (the \"Photographer\") and <u>&nbsp;Max Saperstone&nbsp;\n        </u> (the \"Client\").<br> <strong>Whereas</strong>, Client wishes to\n        engage Photographer to provide certain photography services and\n        Photographer is willing to accept such engagement, all on the terms\n        and conditions set forth herein.<br> <strong>Now therefore</strong>,\n        in consideration of the mutual promises contained herein and other\n        good and valuable consideration, the receipt and sufficiency of which\n        is hereby acknowledged, the parties agree as follows:\n    </p>\n    <ol>\n        <li><strong>Services.</strong> Photographer hereby agrees to provide\n            the photography services set forth on the attached Statement of\n            Services (the \"Services\") to the best of her abilities.</li>\n        <li><strong>Compensation.</strong> In consideration of the Services,\n            Client agrees to pay Photographer the following amounts as follows:\n            <p>\n        Platinum Package: $4300.00<br> \n            </p>\n            <p>\n        Non refundable deposit of $2000 and contract to\n                reserve the date 1983-10-13 <br>\n                Checks should be made payable to <em>Saperstone Studios</em> and\n                mailed to <em>5012 Whisper Willow Dr, Fairfax VA 22030</em> <br>Remaining\n                balance due 3 weeks prior to wedding date.\n            </p></li>\n        <li><strong>Term.</strong> The initial term of this Contract shall\n            commence on the date hereof and terminate upon completion of the\n            services.</li>\n        <li><strong>Standard Terms.</strong> Attached hereto is a statement of\n            Standard Terms and Conditions which will apply to the relationship\n            between Photographer and Client; such terms and conditions are\n            incorporated herein by this reference.</li>\n    </ol>\n    <p>\n        <strong>In witness whereof</strong>, the undersigned have caused this\n        Contract to be executed as of the date first above written.\n    \n    \n    </p><h4>Client:</h4>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Name:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-name-signature\" class=\"form-control keep\" type=\"text\" placeholder=\"Client Name\" value=\"\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Signature:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <div id=\"contract-signature\" class=\"signature\"></div>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Address:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <textarea id=\"contract-address\" class=\"form-control keep\" type=\"text\" placeholder=\"Client Address\" value=\"\">5012 Whisper Willow Dr\nFairfax, VA 22030</textarea>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Phone Number:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-number\" class=\"form-control keep\" type=\"tel\" placeholder=\"Client Phone Number\" value=\"(571) 245-3351\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Email: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-email\" class=\"form-control keep\" type=\"email\" placeholder=\"Client Email\" value=\"msaperst@gmail.com\">\n        </div>\n    </div>\n    <h4>Ceremony Venue:</h4>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Name: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-ceremony-venue-name\" class=\"form-control keep\" type=\"text\" placeholder=\"Ceremony Venue Name\" value=\"Blah\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Address: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <textarea id=\"contract-ceremony-venue-address\" class=\"form-control keep\" type=\"text\" placeholder=\"Ceremony Venue Address\" value=\"\">Someplace</textarea>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Phone Number: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-ceremony-venue-number\" class=\"form-control keep\" type=\"text\" placeholder=\"Ceremony Venue Phone Number\" value=\"yeah\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Email: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-ceremony-venue-email\" class=\"form-control keep\" type=\"text\" placeholder=\"Ceremony Venue Email\" value=\"poop\">\n        </div>\n    </div>\n    <h4>Reception Venue:</h4>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Name: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-reception-venue-name\" class=\"form-control keep\" type=\"text\" placeholder=\"Reception Venue Name\" value=\"Another place\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Address: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <textarea id=\"contract-reception-venue-address\" class=\"form-control keep\" type=\"text\" placeholder=\"Reception Venue Address\" value=\"\">goodluck!!!</textarea>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Phone Number: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-reception-venue-number\" class=\"form-control keep\" type=\"text\" placeholder=\"Reception Venue Phone Number\" value=\"1234567890\">\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Email: </strong>\n        </div>\n        <div class=\"col-md-9\">\n            <input id=\"contract-reception-venue-email\" class=\"form-control keep\" type=\"text\" placeholder=\"Reception Venue Email\" value=\"nope\">\n        </div>\n    </div>\n    <h4>Photographer:</h4>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Name:</strong>\n        </div>\n        <div class=\"col-md-9\">\n        Saperstone Studios<br> Leigh Ann Saperstone\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Address: </strong>\n        </div>\n        <div class=\"col-md-9\">\n        5012 Whisper Willow Dr.<br>Fairfax, VA 22030\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Phone Number:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <a target=\"_blank\" href=\"tel:5712660004\">(571) 266-0004</a>\n        </div>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Email:</strong>\n        </div>\n        <div class=\"col-md-9\">\n            <a target=\"_blank\" href=\"mailto:contracts@saperstonestudios.com\">contracts@saperstonestudios.com</a>\n        </div>\n    </div>\n    <p></p>\n    <h3>Exhibit A: Statement Of Services</h3>\n    <div class=\"row\">\n        <div class=\"col-md-3\">\n            <strong>Project/Assignment:</strong>\n        </div>\n        <div class=\"col-md-9\">\n        Wedding Photography | Platinum Package |\n        photojournalistic style documentation\n        </div>\n    </div>\n        800+ color managed and retouched images with print release<br>9 hours of wedding day coverage<br>2nd photographer<br>Engagement session<br>Engagement sign in book<br>Photobooth<br>Web gallery for sharing<br>USB of final images<br>$200 print credit\n            <h3>Standard Terms and Conditions</h3>\n    <p>\n        <strong>Copyright.</strong> The photographs produced by Photographer\n        shall be the intellectual property and copyrighted works of\n        Photographer, and shall not be deemed to be works made for hire.\n                                                                   Photographer agrees to give, upon payment in full, a limited usage\n        license to Client for personal, non-commercial reproduction and\n        display of selected photographs. Additionally, the files delivered may\n        only be reproduced for personal use and cannot under any circumstance\n        be sold or used for business, advertising, or trade purposes without\n        written authorization from Photographer. Photographer retains creative\n        control over the images produced and all decisions made by\n        Photographer with regards to edits are deemed final.\n    </p>\n    <p>\n        <strong>Credit.</strong> In any publication, display, exhibit or other\n        permitted use of the photographs of Photographer, Client agrees to\n        include photo credit to Photographer and include a copyright notice\n        evidence of Photographerâ€™s ownership thereof. In addition, in any\n        publication in which the artists are recognized, Client shall include\n        a brief biography of Photographer approved by Photographer of\n        comparable position and prominence to other artists whose work is\n        included.\n    </p>\n    <p>\n        <strong>Retouch.</strong> Retouching is included but at the\n        Photographers discretion. Any additional retouch requests are handled\n        on a case by case basis and a separate fee may be negotiated.\n    </p>\n    <p>\n        <strong>Scheduling.</strong> Client will be responsible for insuring\n                                                                    access and authority to enable Photographer to shoot on the dates set\n        forth. If Photographer is unable to shoot on the dates scheduled for\n            reasons beyond Photographerâ€™s or Clientâ€™s reasonable control, the\n        parties will endeavor to agree on mutually acceptable alternative\n        dates, subject to Photographer availability.\n    </p>\n    <p>\n        <strong>Color Changes.</strong> Client recognizes that color dyes in\n        photography may fade or discolor over time due to the inherent\n        qualities of dyes; Photographer shall have no liability for any claims\n                                                                    based upon fading or discoloration due to such inherent qualities.\n    </p>\n    <p>\n        <strong>Advertising.</strong> Client gives Photographer permission to\n        use photographs for advertising (example: website).\n    </p>\n    <p>\n        <strong>Payment &amp; Charges.</strong> If any payment due Photographer is\n        not be made within 30 days of its due date, Photographer shall have\n        the options to assess a service charge equal 1.5% of the outstanding\n        amount each month (or fraction thereof) thereafter that payment is\n        late. If Photographer institutes any proceeding to obtain payment from\n        Client, Client will pay any costs and expenses (including reasonable\n        attorney\'s fees) incurred by Photographer in connection therewith. If\n        check payment does not process, client is liable for all processing,\n        late and overdraft charges.\n    </p>\n    <p>\n        <strong>Limit on Liability.</strong> Absent willful misconduct or\n        infringement by Photographer of intellectual property rights of any\n        third party, the liability of Photographer to Client arising out of\n        the Services shall not exceed the fees paid to Photographer hereunder.\n        In no event shall Photographer have any liability for special,\n        incidental, indirect, consequential or punitive damages hereunder.\n    </p>\n    <p>\n        <strong>Permissions.</strong> Client shall be solely responsible for\n        obtaining all permissions and consent of persons whose photographs are\n        taken and of owners of property and indemnify Photographer from any\n        claims, costs and expenses arising from any failure to do so.\n    </p>\n    <p>\n        <strong>Relationship.</strong> The relationship between Photographer\n        and Client is one of independent contractor. Photographer shall be\n        responsible for payment of all federal, state and local income,\n        payroll and withholding taxes and assessments arising from or\n        attributable to receipt of payments hereunder.\n    </p>\n    <p>\n        <strong>Miscellaneous.</strong> (a) The provisions hereof shall\n        survive termination of this Agreement; (b) this Agreement will be\n        governed by the laws of the State of Virginia (c) this Agreement\n        contains the entire agreement between the parties with respect to the\n        subject matter hereof and supersedes all prior understandings among\n        the parties with respect thereto; this Agreement may be changed only\n        in writing signed by the party against whom enforcement is sought; (d)\n        this Agreement may be executed in counterpart originals, each of which\n        shall constitute an original and all of which together shall\n        constitute a single document and shall be effective upon execution by\n        both parties; and (e) this Agreement shall be binding upon the parties\n        hereto and their respective successors and assigns; no party shall\n        assign its duties or obligations hereunder without the prior written\n        consent of the other party hereto.\n    </p>', 'data:image/png;base64,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', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIMAAAAhCAYAAAD6SRiDAAAEYUlEQVR4Xu2aTWgkRRTH/6+ziR9gyDEE111XCXhZk67JxItrVlFk9bAXb/ETFxZWUBA1eBEPi4iKsnjQi+KSi3r0Ay+usreQru4wiBBEcDWH4EGCibo7le4nNVbHzmxP0pmpkJ7uLghkpquK9/7vN1WvXxWhapUCRgGqlKgUiBXoSxhqtdpMFEW3+L7/RRVKewr0BQwTExMPDgwMCADHANwHYBwAAzgqpfzVnhzlninXMExNTR1m5leY+VxamIho3vO8x8sdQnve5xIG13XvBXCGiDoGmohCZh4A8JKU8m17kpR3plzBYFaCl5n5ubaQbAL4HMBlZr5KRB8nnjMzv+j7/rvlDaMdz3MBgxDiJICnADzR5tbPzHze9/1k8CGEeAPAnMkbWj4w8yUAb/m+/40daco3y4HDYEDQgUy2JjOfbYcg2UEI8TeAm8x3+v+bNROO4xxZXFz8rXyh7N3jA4VBCPEIAP16GNuRuhJ0cjOxQrQWBz1PlVR2D8WBwSCEeBbABwB0EqiTwTM7rQSdXNQ1B2b+Wq8SVVLZPQh65L7AUKvVToVheC0Igm/bzTOrwVkAj5pnfyil7mo0Gr9364oB4rsqqexWwf/GWYfBdd0XiKiV2TPzT0T0PYAfABwBcNoUjmKrm0qpw72AEE9UJZW9gWAVBiHEaWZ+nYiOG7MiAM4OJl5TSt1mA4QEEFVS2QMTVlaGmZmZG9fX1//JaIeuF3wipfwqY/89dauSyj3Jta2zFRiEEDqTj9uFKIo+dBznBAD995jZMl4bHBy8uLCwsNK9udlGpiWVURTNBUHwZrYZdu9Vr9fHlVKHgiD4cffe/dHDKgxEdNLzPJ0jHHhLSSqjMAzvWFpa+qVX41zXPUdE7wD4Uyl1e6PR+KvXOfMw3goMeXAkzYb2pLLXGsTk5OQJx3HeAzDZSrgKdlBWaBh0wOJKZaIGMSelzLRduK77sOM4x5n5zsTReczdFSnl0bz+ELqxq/AwpG0XSqnh3Zb2er1+fxiG19VJjMgXpJTPdyN4nscUHgazOmw72CKiJz3Pu9gpMKYw9mXKc0VED+UlL7INVilgMEBcBXCDEfCSlPKBDnmGro6+b8rkulbyqT46j6LocpHeHNJ8Lw0Mruu+SkTn9TmIDjQz3+37fiMpihDCBSDNdz2XyW3/cvd7vtLAMD09fevm5mbyaFsXvvQdiq0mhFAADgGwVibf7wDanL80MJit4rO4CAYgiqLoWBAEV8wzfadCX7LR7R4p5YJNofthrkwwzM7OPs3MH/WDQzvZuLGxgZWV/wugw8PDGBsbw+rqKtbW1lpDR0ZGMDo62u+ubrOfiJ6Zn5/fdlus65yhKDBoAZaXl/Vp6pYWQ0NDaDabrc+O42B8XN/CL1azCkORpEmpO8TuNaWU8dtGkVzO7EumbSLzbH3Sse1kU1tdyCLSXsNRShhMwqjvPujzhVNFLSJVMOxVgar/lgKlXRkqBq5XoIKhomJLgX8Bcz7JMUXoNgIAAAAASUVORK5CYII=', '../user/contracts/Max Saperstone - 2020-08-10 - Wedding Contract.pdf')");
        $this->sql->executeStatement("INSERT INTO `contract_line_items` (`contract`, `item`, `amount`, `unit`) VALUES (998, 'Hugs', 20.00, 'with arms')");
        $this->sql->executeStatement("INSERT INTO `contract_line_items` (`contract`, `item`, `amount`, `unit`) VALUES (998, 'Kisses', 50.00, 'with lips')");
    }

    /**
     * @throws Exception
     */
    public function tearDown() {
        $this->http = NULL;
        $this->sql->executeStatement("DELETE FROM `contracts` WHERE `contracts`.`id` = 998;");
        $this->sql->executeStatement("DELETE FROM `contracts` WHERE `contracts`.`id` = 999;");
        $this->sql->executeStatement("DELETE FROM `contract_line_items` WHERE `contract_line_items`.`contract` = 998;");
        $count = $this->sql->getRow("SELECT MAX(`id`) AS `count` FROM `contracts`;")['count'];
        $count++;
        $this->sql->executeStatement("ALTER TABLE `contracts` AUTO_INCREMENT = $count;");
        $this->sql->disconnect();
    }

    public function testNotLoggedIn() {
        try {
            $this->http->request('POST', 'api/get-contracts.php');
        } catch (GuzzleException | ClientException $e) {
            $this->assertEquals(401, $e->getResponse()->getStatusCode());
            $this->assertEquals("", $e->getResponse()->getBody());
        }
    }

    /**
     * @throws GuzzleException
     */
    public function testLoggedInAsDownloader() {
        $cookieJar = CookieJar::fromArray([
            'hash' => '5510b5e6fffd897c234cafe499f76146'
        ], getenv('DB_HOST'));
        try {
            $this->http->request('POST', 'api/get-contracts.php', [
                'cookies' => $cookieJar
            ]);
        } catch (ClientException $e) {
            $this->assertEquals(401, $e->getResponse()->getStatusCode());
            $this->assertEquals("You do not have appropriate rights to perform this action", $e->getResponse()->getBody());
        }
    }

    /**
     * @throws GuzzleException
     */
    public function testContracts() {
        $cookieJar = CookieJar::fromArray([
            'hash' => '1d7505e7f434a7713e84ba399e937191'
        ], getenv('DB_HOST'));
        $response = $this->http->request('POST', 'api/get-contracts.php', [
            'cookies' => $cookieJar
        ]);
        $this->assertEquals(200, $response->getStatusCode());
        $contractInfo = json_decode($response->getBody(), true)['data'];
        $this->assertTrue(2 <= sizeof($contractInfo));
        $this->assertEquals('998', $contractInfo[sizeof($contractInfo) - 2]['id']);
        $this->assertEquals('8e07fb32bf072e1825df8290a7bcdc57', $contractInfo[sizeof($contractInfo) - 2]['link']);
        $this->assertEquals('commercial', $contractInfo[sizeof($contractInfo) - 2]['type']);
        $this->assertEquals('MaxMaxMax', $contractInfo[sizeof($contractInfo) - 2]['name']);
        $this->assertEquals('2021-10-13', $contractInfo[sizeof($contractInfo) - 2]['date']);
        $this->assertEquals('Some session', $contractInfo[sizeof($contractInfo) - 2]['session']);
        $this->assertEquals('0.00', $contractInfo[sizeof($contractInfo) - 2]['amount']);
        $this->assertNull($contractInfo[sizeof($contractInfo) - 2]['signature']);
        $this->assertNull($contractInfo[sizeof($contractInfo) - 2]['file']);
        $this->assertEquals('999', $contractInfo[sizeof($contractInfo) - 1]['id']);
        $this->assertEquals('735870e9bd79af1904a0a2eb453430ed', $contractInfo[sizeof($contractInfo) - 1]['link']);
        $this->assertEquals('wedding', $contractInfo[sizeof($contractInfo) - 1]['type']);
        $this->assertEquals('Max Saperstone', $contractInfo[sizeof($contractInfo) - 1]['name']);
        $this->assertEquals('1983-10-13', $contractInfo[sizeof($contractInfo) - 1]['date']);
        $this->assertEquals('Platinum Package', $contractInfo[sizeof($contractInfo) - 1]['session']);
        $this->assertEquals('4300.00', $contractInfo[sizeof($contractInfo) - 1]['amount']);
        $this->assertStringStartsWith('data:image/png;base64,', $contractInfo[sizeof($contractInfo) - 1]['signature']);
        $this->assertEquals('../user/contracts/Max Saperstone - 2020-08-10 - Wedding Contract.pdf', $contractInfo[sizeof($contractInfo) - 1]['file']);
    }
}
